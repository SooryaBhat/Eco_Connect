{% extends "base.html" %}

{% block title %}{{ tr("Buy Waste") }}{% endblock %}

{% block content %}
<div class="container my-4">

    <div class="row">
        <div class="col-12">
            <div class="card bg-success text-white mb-4">
                <div class="card-body text-center">
                    <h3><i class="fas fa-industry"></i> {{ tr("Welcome") }}, {{ current_user.username }}!</h3>
                    <p class="mb-0">{{ tr("Recycler") }} - {{ current_user.location }}</p>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0">
                <i class="fas fa-shopping-cart"></i>
                {{ tr("Available Waste in") }} {{ current_user.location }}
            </h5>
        </div>

        <div class="card-body">
            {% if waste_listings %}
            <div class="row">

                {% for waste in waste_listings %}
                <div class="col-md-6 col-lg-4 mb-4">

                    <div class="card h-100 shadow-sm">

                        {% if waste.image_path %}
                        <img src="{{ url_for('static', filename='../uploads/' + waste.image_path) }}"
                             class="card-img-top"
                             style="height:200px; object-fit:cover;">
                        {% else %}
                        <div class="bg-light d-flex align-items-center justify-content-center" style="height:200px;">
                            <i class="fas fa-recycle fa-4x text-muted"></i>
                        </div>
                        {% endif %}

                        <div class="card-body">
                            <h5 class="card-title">{{ tr(waste.waste_type) }}</h5>
                            <p class="card-text">
                                {{ waste.description if waste.description else tr("No description") }}
                            </p>

                            <ul class="list-unstyled">
                                <li><strong>{{ tr("Quantity") }}:</strong> {{ waste.quantity }} kg</li>
                                <li><strong>{{ tr("Price") }}:</strong> â‚¹{{ waste.price if waste.price else tr("Negotiable") }}</li>
                                <li><strong>{{ tr("Seller") }}:</strong> {{ waste.seller.username }}</li>
                                <li><strong>{{ tr("Contact") }}:</strong> {{ waste.seller.contact }}</li>
                            </ul>
                        </div>

                        <div class="card-footer">
                            <small class="text-muted">
                                <i class="fas fa-clock"></i> {{ waste.created_at.strftime('%Y-%m-%d') }}
                            </small>
                        </div>

                    </div>

                </div>
                {% endfor %}

            </div>
            {% else %}
            <div class="text-center py-5">
                <i class="fas fa-box-open fa-4x text-muted mb-3"></i>
                <p class="text-muted">{{ tr("No waste available for purchase in your area.") }}</p>
            </div>
            {% endif %}
        </div>
    </div>

</div>
{% endblock %}
